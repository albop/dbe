<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CO2 Emissions and the Kusnetz curve – Data-Based Economics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8fce3f6019bb826be6beab376ba71255.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      Data-Based Economics
      </li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Data-Based Economics</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataframes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_3/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_4/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_5/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Instrumental Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_6/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Machine Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_7/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Machine Learning (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_8/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_10/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Exam 🤞</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-work" id="toc-data-work" class="nav-link active" data-scroll-target="#data-work">1. Data Work</a>
  <ul class="collapse">
  <li><a href="#importing-co2-data" id="toc-importing-co2-data" class="nav-link" data-scroll-target="#importing-co2-data">Importing CO2 Data</a></li>
  <li><a href="#cleaning-up-co2-data" id="toc-cleaning-up-co2-data" class="nav-link" data-scroll-target="#cleaning-up-co2-data">Cleaning up CO2 Data</a></li>
  <li><a href="#importing-world-bank-data" id="toc-importing-world-bank-data" class="nav-link" data-scroll-target="#importing-world-bank-data">Importing World Bank Data</a></li>
  <li><a href="#merging-co2-and-world-bank-data" id="toc-merging-co2-and-world-bank-data" class="nav-link" data-scroll-target="#merging-co2-and-world-bank-data">Merging CO2 and World Bank Data</a></li>
  </ul></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">2. Data exploration</a>
  <ul class="collapse">
  <li><a href="#graphical-representation" id="toc-graphical-representation" class="nav-link" data-scroll-target="#graphical-representation">2.1 Graphical representation</a></li>
  <li><a href="#geo-analysis" id="toc-geo-analysis" class="nav-link" data-scroll-target="#geo-analysis">2.2 Geo-analysis</a></li>
  </ul></li>
  <li><a href="#the-kusnetz-curve" id="toc-the-kusnetz-curve" class="nav-link" data-scroll-target="#the-kusnetz-curve">3. The Kusnetz curve</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CO2 Emissions and the Kusnetz curve</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this exercise, you must use data from the WorldBank to check whether CO2 Emissions can be explained by income per capita.</p>
<div id="ddcf6b7c-29e9-4104-9417-96125926eadc" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-work" class="level2">
<h2 class="anchored" data-anchor-id="data-work">1. Data Work</h2>
<section id="importing-co2-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-co2-data">Importing CO2 Data</h3>
<p><strong>Import the data from file <code>/files/tutorials/session_9/data/API_EN.ATM.CO2E.PC_DS2_en_csv_v2_5177406.csv</code> as a dataframe <code>df_wide</code>. (This table was downloaded from the worldbank website)</strong></p>
<p>Hints: check the documentation from <code>pandas.read_csv()</code> to avoid the import error. You can check the first few lines of the file by typing in a cell: <code>!/files/tutorials/session_9_wrap_up/data/API_EN.ATM.CO2E.PC_DS2_en_csv_v2_5177406.csv</code></p>
<p>Hint2: Check that all columns are well defined.</p>
<div id="3d98e738-be16-43dd-be3f-8c7a7cb27494" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>path_data<span class="op">=</span><span class="st">'data/API_EN.ATM.CO2E.PC_DS2_en_csv_v2_5177406.csv'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df_wide <span class="op">=</span> pd.read_csv(path_data, skiprows<span class="op">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="275a14ab-d932-4b33-9404-d4ce94ed706c" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:true}" data-scrolled="true" data-execution_count="6">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">1960</th>
<th data-quarto-table-cell-role="th">1961</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1963</th>
<th data-quarto-table-cell-role="th">1964</th>
<th data-quarto-table-cell-role="th">1965</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">2013</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2020</th>
<th data-quarto-table-cell-role="th">2021</th>
<th data-quarto-table-cell-role="th">Unnamed: 66</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Aruba</td>
<td>ABW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.995665</td>
<td>1.006938</td>
<td>0.956704</td>
<td>0.938565</td>
<td>0.928508</td>
<td>0.908094</td>
<td>0.903764</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.189910</td>
<td>0.149162</td>
<td>0.176278</td>
<td>0.153019</td>
<td>0.134106</td>
<td>0.165455</td>
<td>0.160976</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.499219</td>
<td>0.506918</td>
<td>0.485478</td>
<td>0.490807</td>
<td>0.474882</td>
<td>0.478305</td>
<td>0.485884</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Angola</td>
<td>AGO</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>1.031093</td>
<td>1.092216</td>
<td>1.125224</td>
<td>1.020760</td>
<td>0.802751</td>
<td>0.766143</td>
<td>0.779203</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">261</td>
<td>Kosovo</td>
<td>XKX</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">262</td>
<td>Yemen, Rep.</td>
<td>YEM</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>1.031352</td>
<td>0.988351</td>
<td>0.475163</td>
<td>0.370636</td>
<td>0.333285</td>
<td>0.315682</td>
<td>0.351859</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">263</td>
<td>South Africa</td>
<td>ZAF</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>8.110093</td>
<td>8.184427</td>
<td>7.602659</td>
<td>7.534968</td>
<td>7.691396</td>
<td>7.575040</td>
<td>7.568640</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">264</td>
<td>Zambia</td>
<td>ZMB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.278307</td>
<td>0.298009</td>
<td>0.305264</td>
<td>0.317276</td>
<td>0.393686</td>
<td>0.433396</td>
<td>0.369958</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">265</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.905911</td>
<td>0.871840</td>
<td>0.878139</td>
<td>0.762487</td>
<td>0.700965</td>
<td>0.822472</td>
<td>0.765894</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>266 rows × 67 columns</p>
</div>
</div>
</div>
<p><font color="blue"><strong>Question 1: <em>Describe briefly the data.</em></strong> </font></p>
<p><em>The data contains information on the level of carbon dioxide (CO2) emissions per capita (in metric tons) for different countries and regions over the years 1960 to 2019. The data is sourced from the World Bank’s World Development Indicators and is reported annually.</em></p>
<p><em>The dataset contains 264 rows (corresponding to different countries and regions) and 61 columns (corresponding to the years 1960 to 2019 and additional columns with country and region information). The data is in a wide format, with each row representing a country/region and each column representing a year.</em></p>
<p><em>The data is useful for analyzing trends in CO2 emissions over time and comparing emissions across countries and regions. It can also be used for exploring the relationship between CO2 emissions and various economic and environmental factors.</em></p>
<div id="ed094609-b83d-4632-a258-1f6749075b0d" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:true}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_wide.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1960</th>
<th data-quarto-table-cell-role="th">1961</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1963</th>
<th data-quarto-table-cell-role="th">1964</th>
<th data-quarto-table-cell-role="th">1965</th>
<th data-quarto-table-cell-role="th">1966</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1968</th>
<th data-quarto-table-cell-role="th">1969</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">2013</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2020</th>
<th data-quarto-table-cell-role="th">2021</th>
<th data-quarto-table-cell-role="th">Unnamed: 66</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>4.288766</td>
<td>4.194242</td>
<td>4.141210</td>
<td>4.140690</td>
<td>4.148584</td>
<td>4.128191</td>
<td>4.086604</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>5.002821</td>
<td>4.862196</td>
<td>4.731198</td>
<td>4.653372</td>
<td>4.585664</td>
<td>4.489473</td>
<td>4.474616</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.024987</td>
<td>0.027090</td>
<td>0.037289</td>
<td>0.029718</td>
<td>0.033815</td>
<td>0.035826</td>
<td>0.035704</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.720891</td>
<td>0.785259</td>
<td>0.771880</td>
<td>0.769068</td>
<td>0.802179</td>
<td>0.797275</td>
<td>0.790333</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>2.726281</td>
<td>2.888558</td>
<td>2.827949</td>
<td>2.760181</td>
<td>2.699348</td>
<td>2.979403</td>
<td>2.981762</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>6.264131</td>
<td>6.028664</td>
<td>5.792812</td>
<td>5.828931</td>
<td>6.021844</td>
<td>5.950694</td>
<td>5.890683</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>37.420762</td>
<td>36.875726</td>
<td>35.111798</td>
<td>33.493040</td>
<td>32.281678</td>
<td>31.235406</td>
<td>32.761775</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>8 rows × 63 columns</p>
</div>
</div>
</div>
<div id="fd839056" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get rid of last column</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df_wide <span class="op">=</span> df_wide.iloc[:,:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">1960</th>
<th data-quarto-table-cell-role="th">1961</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1963</th>
<th data-quarto-table-cell-role="th">1964</th>
<th data-quarto-table-cell-role="th">1965</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">2011</th>
<th data-quarto-table-cell-role="th">2012</th>
<th data-quarto-table-cell-role="th">2013</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Aruba</td>
<td>ABW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.970188</td>
<td>0.983547</td>
<td>0.995665</td>
<td>1.006938</td>
<td>0.956704</td>
<td>0.938565</td>
<td>0.928508</td>
<td>0.908094</td>
<td>0.903764</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.305308</td>
<td>0.265210</td>
<td>0.189910</td>
<td>0.149162</td>
<td>0.176278</td>
<td>0.153019</td>
<td>0.134106</td>
<td>0.165455</td>
<td>0.160976</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.468718</td>
<td>0.472242</td>
<td>0.499219</td>
<td>0.506918</td>
<td>0.485478</td>
<td>0.490807</td>
<td>0.474882</td>
<td>0.478305</td>
<td>0.485884</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Angola</td>
<td>AGO</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.983960</td>
<td>0.947663</td>
<td>1.031093</td>
<td>1.092216</td>
<td>1.125224</td>
<td>1.020760</td>
<td>0.802751</td>
<td>0.766143</td>
<td>0.779203</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">261</td>
<td>Kosovo</td>
<td>XKX</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">262</td>
<td>Yemen, Rep.</td>
<td>YEM</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.900862</td>
<td>0.801193</td>
<td>1.031352</td>
<td>0.988351</td>
<td>0.475163</td>
<td>0.370636</td>
<td>0.333285</td>
<td>0.315682</td>
<td>0.351859</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">263</td>
<td>South Africa</td>
<td>ZAF</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>7.803853</td>
<td>8.030478</td>
<td>8.110093</td>
<td>8.184427</td>
<td>7.602659</td>
<td>7.534968</td>
<td>7.691396</td>
<td>7.575040</td>
<td>7.568640</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">264</td>
<td>Zambia</td>
<td>ZMB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.213798</td>
<td>0.273319</td>
<td>0.278307</td>
<td>0.298009</td>
<td>0.305264</td>
<td>0.317276</td>
<td>0.393686</td>
<td>0.433396</td>
<td>0.369958</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">265</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.875955</td>
<td>0.905368</td>
<td>0.905911</td>
<td>0.871840</td>
<td>0.878139</td>
<td>0.762487</td>
<td>0.700965</td>
<td>0.822472</td>
<td>0.765894</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>266 rows × 65 columns</p>
</div>
</div>
</div>
<p>The data contains yearly carbon emissions <em>per capita</em>, for all countries, starting in 1960 until 2021 (with some missing data)</p>
</section>
<section id="cleaning-up-co2-data" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-up-co2-data">Cleaning up CO2 Data</h3>
<p><font color="blue"><strong>Question 2: convert the data into the long format using the function <code>pandas.melt()</code>. The columns of the new table <code>df_long</code> should be: <code>["Country Name","Country Code","Indicator Name","Indicator Code", "Date", "Emissions"]</code></strong> </font></p>
<div id="1f23d51f-53e8-4782-8080-694af6279a8a" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="op">=</span> pd.melt(df_wide,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>        id_vars<span class="op">=</span>[<span class="st">"Country Name"</span>,<span class="st">"Country Code"</span>,<span class="st">"Indicator Name"</span>,<span class="st">"Indicator Code"</span>],</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        var_name<span class="op">=</span><span class="st">"Date"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        value_name<span class="op">=</span><span class="st">"Emissions"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="292c7c32" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_long.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Emissions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7981</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.982136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7982</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.222538</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7983</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.473669</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7984</td>
<td>Angola</td>
<td>AGO</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.554586</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7985</td>
<td>Albania</td>
<td>ALB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>1.819542</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><font color="blue"><strong>Question 3: Eliminate all rows for which no emission data is available</strong></font></p>
<div id="6623d710-fa95-4b53-a5b8-6d158417917e" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="op">=</span> df_long.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><font color="blue"><strong>Question 4: Convert the <code>Date</code> column into a date format.</strong></font></p>
<p><em>Hint: look for pandas.to_datetime() (This is not absolutely mandatory but makes graphs nicer)</em></p>
<div id="00cbb834" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_long[<span class="st">'Date'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>7981     1990
7982     1990
7983     1990
7984     1990
7985     1990
         ... 
15954    2019
15956    2019
15957    2019
15958    2019
15959    2019
Name: Date, Length: 7147, dtype: object</code></pre>
</div>
</div>
<div id="0c63c589-38b6-4ac8-947c-0f351dc3d72f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_long[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(df_long[<span class="st">'Date'</span>])</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_long[<span class="st">'Date'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>7981    1990-01-01
7982    1990-01-01
7983    1990-01-01
7984    1990-01-01
7985    1990-01-01
           ...    
15954   2019-01-01
15956   2019-01-01
15957   2019-01-01
15958   2019-01-01
15959   2019-01-01
Name: Date, Length: 7147, dtype: datetime64[ns]</code></pre>
</div>
</div>
</section>
<section id="importing-world-bank-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-world-bank-data">Importing World Bank Data</h3>
<p>From the world bank website, we download data for historical <strong>real gdp</strong> and <strong>population</strong>.</p>
<p><strong>Checkout the <a href="https://github.com/OliverSherouse/wbdata">wbdata</a> library. Import time series for GDP and Total Population for all countries.</strong></p>
<div id="c6f27404-8299-4a8e-9d78-d5182f4ce32a" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wbdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5c5a9c05-b6cf-47ed-93b1-0e31a983e3ac" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>indicators <span class="op">=</span> {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NY.GDP.MKTP.CD"</span>: <span class="st">"GDP"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SP.POP.TOTL"</span>: <span class="st">"Total Population"</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>df_wb <span class="op">=</span> wbdata.get_dataframe(indicators).reset_index()</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>df_wb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">GDP</th>
<th data-quarto-table-cell-role="th">Total Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Africa Eastern and Southern</td>
<td>2023</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa Eastern and Southern</td>
<td>2022</td>
<td>1.185138e+12</td>
<td>720859132.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Africa Eastern and Southern</td>
<td>2021</td>
<td>1.086531e+12</td>
<td>702977106.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa Eastern and Southern</td>
<td>2020</td>
<td>9.288802e+11</td>
<td>685112979.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Africa Eastern and Southern</td>
<td>2019</td>
<td>1.006191e+12</td>
<td>667242986.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17019</td>
<td>Zimbabwe</td>
<td>1964</td>
<td>1.217138e+09</td>
<td>4310332.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17020</td>
<td>Zimbabwe</td>
<td>1963</td>
<td>1.159512e+09</td>
<td>4177931.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17021</td>
<td>Zimbabwe</td>
<td>1962</td>
<td>1.117602e+09</td>
<td>4049778.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17022</td>
<td>Zimbabwe</td>
<td>1961</td>
<td>1.096647e+09</td>
<td>3925952.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17023</td>
<td>Zimbabwe</td>
<td>1960</td>
<td>1.052990e+09</td>
<td>3806310.0</td>
</tr>
</tbody>
</table>

<p>17024 rows × 4 columns</p>
</div>
</div>
</div>
<p><font color="blue"><strong>Question 5: Change the format of column <code>date</code> to datetime.</strong></font></p>
<div id="6df3f198-4ad8-4680-9a26-44c547adab41" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_wb[<span class="st">'date'</span>] <span class="op">=</span>  pd.to_datetime(df_wb[<span class="st">'date'</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df_wb.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">GDP</th>
<th data-quarto-table-cell-role="th">Total Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Africa Eastern and Southern</td>
<td>2023-01-01</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa Eastern and Southern</td>
<td>2022-01-01</td>
<td>1.185138e+12</td>
<td>720859132.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Africa Eastern and Southern</td>
<td>2021-01-01</td>
<td>1.086531e+12</td>
<td>702977106.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa Eastern and Southern</td>
<td>2020-01-01</td>
<td>9.288802e+11</td>
<td>685112979.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Africa Eastern and Southern</td>
<td>2019-01-01</td>
<td>1.006191e+12</td>
<td>667242986.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><font color="blue"><strong>Question 6: Change columns of <code>df_wb</code> to [“Country Name”, “Date”, “GDP”, “Population”].</strong></font></p>
<div id="2bb4e827-d1f1-4cf8-a2b0-d3ce93244b37" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_wb.columns <span class="op">=</span>  [<span class="st">"Country Name"</span>, <span class="st">"Date"</span>, <span class="st">"GDP"</span>, <span class="st">"Population"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="dff5ba54" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_wb.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>Index(['Country Name', 'Date', 'GDP', 'Population'], dtype='object')</code></pre>
</div>
</div>
</section>
<section id="merging-co2-and-world-bank-data" class="level3">
<h3 class="anchored" data-anchor-id="merging-co2-and-world-bank-data">Merging CO2 and World Bank Data</h3>
<p><font color="blue"><strong>Question 7: Merge the datafames df_wb and df_long into a single dataframe <code>df_kuznetz</code>.</strong></font></p><font color="blue">
<p>We perform the same steps as in the first part for both series then <code>merge</code> the resulting long databases “on” the <code>Country Code</code> and <code>Date</code> columns.</p>
<p>You should obtain one single database <code>data</code> containing the columns <code>["Country Name","Country Code","Indicator Name","Indicator Code","Date", "Emissions", "GDP", "Population"]</code></p>
<div id="21f7d27b-6f98-4fe3-bc66-1eb32dfbdc28" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_kuznets <span class="op">=</span> df_long.merge(df_wb, on<span class="op">=</span>[<span class="st">"Country Name"</span>,<span class="st">"Date"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</font></section><font color="blue">
</font></section><font color="blue">
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">2. Data exploration</h2>
<section id="graphical-representation" class="level3">
<h3 class="anchored" data-anchor-id="graphical-representation">2.1 Graphical representation</h3>
<p><font color="blue"><strong>Question 8: Compute total emissions for each country.</strong></font></p>
<div id="967f2b1c" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let' s compute total emissions (for each year):</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df_kuznets[<span class="st">"TEmissions"</span>] <span class="op">=</span> df_kuznets[<span class="st">"Emissions"</span>]<span class="op">*</span>df_kuznets[<span class="st">"Population"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f3b9b286" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_kuznets.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Emissions</th>
<th data-quarto-table-cell-role="th">GDP</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">TEmissions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990-01-01</td>
<td>0.982136</td>
<td>2.546735e+11</td>
<td>309890664.0</td>
<td>3.043549e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990-01-01</td>
<td>0.222538</td>
<td>NaN</td>
<td>10694796.0</td>
<td>2.380000e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990-01-01</td>
<td>0.473669</td>
<td>1.218036e+11</td>
<td>206739024.0</td>
<td>9.792580e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Angola</td>
<td>AGO</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990-01-01</td>
<td>0.554586</td>
<td>1.123628e+10</td>
<td>11828638.0</td>
<td>6.560000e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Albania</td>
<td>ALB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990-01-01</td>
<td>1.819542</td>
<td>2.028554e+09</td>
<td>3286542.0</td>
<td>5.980000e+06</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="db4c9134" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solution 1: loop over each country</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> country <span class="kw">in</span> df_kuznets[<span class="st">'Country Name'</span>].unique():</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    df_c <span class="op">=</span> df_kuznets[df_kuznets[<span class="st">'Country Name'</span>]<span class="op">==</span>country]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    te <span class="op">=</span> df_c[<span class="st">"TEmissions"</span>].<span class="bu">sum</span>()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Total emissions for '</span><span class="sc">{</span>country<span class="sc">}</span><span class="ss">': </span><span class="sc">{</span>te<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total emissions for 'Africa Eastern and Southern': 13404472170.208675
Total emissions for 'Afghanistan': 95460000.50544737
Total emissions for 'Africa Western and Central': 4638752133.020737
Total emissions for 'Angola': 553169997.2534183
Total emissions for 'Albania': 112550000.08583067
Total emissions for 'Andorra': 14629999.967813494
Total emissions for 'Arab World': 37093235321.97194
Total emissions for 'United Arab Emirates': 3725519996.948244
Total emissions for 'Argentina': 4374320037.231444
Total emissions for 'Armenia': 170760000.12397763
Total emissions for 'Antigua and Barbuda': 12969999.953508377
Total emissions for 'Australia': 10421789732.640446
Total emissions for 'Austria': 1971999996.7956543
Total emissions for 'Azerbaijan': 979830002.1362305
Total emissions for 'Burundi': 8450000.043511389
Total emissions for 'Belgium': 3206549994.5068383
Total emissions for 'Benin': 93380000.51498412
Total emissions for 'Burkina Faso': 53590000.25987626
Total emissions for 'Bangladesh': 1166459997.10083
Total emissions for 'Bulgaria': 1457500005.0354004
Total emissions for 'Bahrain': 627629998.3215332
Total emissions for 'Bahamas, The': 73319999.69482425
Total emissions for 'Bosnia and Herzegovina': 498559999.6948242
Total emissions for 'Belarus': 1852059995.4223633
Total emissions for 'Belize': 16319999.951124186
Total emissions for 'Bolivia': 398069999.73297113
Total emissions for 'Brazil': 10285349940.185558
Total emissions for 'Barbados': 42829999.6423721
Total emissions for 'Brunei Darussalam': 173419998.85559085
Total emissions for 'Bhutan': 12129999.851584433
Total emissions for 'Botswana': 131520000.4959107
Total emissions for 'Central African Republic': 5859999.993145463
Total emissions for 'Canada': 15436500048.82813
Total emissions for 'Central Europe and the Baltics': 22260059971.733093
Total emissions for 'Switzerland': 1290329992.3706055
Total emissions for 'Chile': 1781930004.8828123
Total emissions for 'China': 180722829257.81247
Total emissions for 'Cote d'Ivoire': 188249999.29428113
Total emissions for 'Cameroon': 188960001.33514407
Total emissions for 'Congo, Dem. Rep.': 74759999.85218048
Total emissions for 'Congo, Rep.': 128630000.61988828
Total emissions for 'Colombia': 1904849990.2343743
Total emissions for 'Comoros': 4220000.019073484
Total emissions for 'Cabo Verde': 10609999.954700474
Total emissions for 'Costa Rica': 183859999.52316266
Total emissions for 'Caribbean small states': 1034020002.796352
Total emissions for 'Cuba': 800550000.6103514
Total emissions for 'Cyprus': 208309999.80926514
Total emissions for 'Czechia': 3514870001.220703
Total emissions for 'Germany': 24367020053.710922
Total emissions for 'Djibouti': 11989999.972581863
Total emissions for 'Dominica': 4580000.049769873
Total emissions for 'Denmark': 1511560003.0517564
Total emissions for 'Dominican Republic': 544600000.3814697
Total emissions for 'Algeria': 3119610001.2207026
Total emissions for 'East Asia &amp; Pacific (excluding high income)': 210861561722.85782
Total emissions for 'Early-demographic dividend': 145562461072.3832
Total emissions for 'East Asia &amp; Pacific': 284535181803.9547
Total emissions for 'Europe &amp; Central Asia (excluding high income)': 86155186226.18817
Total emissions for 'Europe &amp; Central Asia': 200014743312.3924
Total emissions for 'Ecuador': 868449998.6267085
Total emissions for 'Egypt, Arab Rep.': 4778139994.506838
Total emissions for 'Euro area': 76501155164.6067
Total emissions for 'Spain': 8148009973.144532
Total emissions for 'Estonia': 539469997.7493286
Total emissions for 'Ethiopia': 201770000.4386903
Total emissions for 'European Union': 97925719867.62526
Total emissions for 'Fragile and conflict affected situations': 17546817743.23741
Total emissions for 'Finland': 1666099990.2343762
Total emissions for 'Fiji': 31849999.833107002
Total emissions for 'France': 10543269963.378906
Total emissions for 'Gabon': 166300000.20980832
Total emissions for 'United Kingdom': 14824209992.675781
Total emissions for 'Georgia': 261579998.69346607
Total emissions for 'Ghana': 272250000.05722034
Total emissions for 'Guinea': 58159999.77588653
Total emissions for 'Gambia, The': 10709999.989271168
Total emissions for 'Guinea-Bissau': 6550000.017881391
Total emissions for 'Equatorial Guinea': 156999998.83651733
Total emissions for 'Greece': 2522079996.948241
Total emissions for 'Grenada': 7829999.977350233
Total emissions for 'Guatemala': 318759997.9782105
Total emissions for 'Guyana': 52169999.84741211
Total emissions for 'High income': 381429144218.1322
Total emissions for 'Honduras': 200320001.18255627
Total emissions for 'Heavily indebted poor countries (HIPC)': 3573743664.391078
Total emissions for 'Croatia': 546570000.9918215
Total emissions for 'Haiti': 57419999.87602233
Total emissions for 'Hungary': 1587849992.6757812
Total emissions for 'IBRD only': 421106618483.8625
Total emissions for 'IDA &amp; IBRD total': 441420268999.2764
Total emissions for 'IDA total': 18580350306.178776
Total emissions for 'IDA blend': 11192485878.57648
Total emissions for 'Indonesia': 10537130031.738277
Total emissions for 'IDA only': 7250607880.587167
Total emissions for 'India': 39882729992.67581
Total emissions for 'Ireland': 1160019997.2534175
Total emissions for 'Iran, Islamic Rep.': 12940629923.095703
Total emissions for 'Iraq': 3115859987.79297
Total emissions for 'Iceland': 61519999.81403353
Total emissions for 'Israel': 1735090004.8828127
Total emissions for 'Italy': 12092299953.613281
Total emissions for 'Jamaica': 265480001.6784669
Total emissions for 'Jordan': 555120000.3051757
Total emissions for 'Japan': 35076589707.03126
Total emissions for 'Kazakhstan': 5781750007.934571
Total emissions for 'Kenya': 312409999.38964856
Total emissions for 'Kyrgyz Republic': 250470001.62124643
Total emissions for 'Cambodia': 136179999.8855591
Total emissions for 'Kiribati': 1460000.002682209
Total emissions for 'St. Kitts and Nevis': 6769999.985694885
Total emissions for 'Korea, Rep.': 14407270002.441402
Total emissions for 'Kuwait': 1847130003.2043457
Total emissions for 'Latin America &amp; Caribbean (excluding high income)': 33888466716.879837
Total emissions for 'Lao PDR': 120899998.85082251
Total emissions for 'Lebanon': 545699999.2752075
Total emissions for 'Liberia': 20639999.970197685
Total emissions for 'Libya': 1412920000.9155276
Total emissions for 'St. Lucia': 13999999.854564665
Total emissions for 'Latin America &amp; Caribbean': 41457734332.9309
Total emissions for 'Least developed countries: UN classification': 5059057141.458361
Total emissions for 'Low income': 5012888259.405353
Total emissions for 'Liechtenstein': 6000000.012516974
Total emissions for 'Sri Lanka': 379898067.4122288
Total emissions for 'Lower middle income': 98016438244.47752
Total emissions for 'Low &amp; middle income': 424716971152.3774
Total emissions for 'Lesotho': 14489999.991655348
Total emissions for 'Late-demographic dividend': 300556353021.18164
Total emissions for 'Lithuania': 421159999.65667725
Total emissions for 'Luxembourg': 301879997.253418
Total emissions for 'Latvia': 266580000.34332278
Total emissions for 'Morocco': 1292710004.2724612
Total emissions for 'Moldova': 312960001.56402576
Total emissions for 'Madagascar': 58730000.0
Total emissions for 'Maldives': 24459999.809265155
Total emissions for 'Middle East &amp; North Africa': 51448783593.49841
Total emissions for 'Mexico': 12061159943.847656
Total emissions for 'Middle income': 421343696273.93274
Total emissions for 'North Macedonia': 261080000.95367432
Total emissions for 'Mali': 57979999.38964845
Total emissions for 'Malta': 69689999.53746796
Total emissions for 'Myanmar': 356640002.72750866
Total emissions for 'Middle East &amp; North Africa (excluding high income)': 30549771751.404892
Total emissions for 'Montenegro': 58259999.651908875
Total emissions for 'Mongolia': 400310000.3051756
Total emissions for 'Mozambique': 83620000.10490419
Total emissions for 'Mauritania': 59070000.0667572
Total emissions for 'Mauritius': 84436126.501589
Total emissions for 'Malawi': 25650000.066757202
Total emissions for 'Malaysia': 4726920022.583006
Total emissions for 'North America': 173811979552.8526
Total emissions for 'Niger': 32690000.021457683
Total emissions for 'Nigeria': 2851099994.2016597
Total emissions for 'Nicaragua': 119380000.4196167
Total emissions for 'Netherlands': 4828429971.92383
Total emissions for 'Norway': 1087909998.4741213
Total emissions for 'Nepal': 136439998.78883356
Total emissions for 'Nauru': 2259999.990910291
Total emissions for 'New Zealand': 896769999.3133546
Total emissions for 'OECD members': 369789151172.5048
Total emissions for 'Oman': 1173599988.7847903
Total emissions for 'Other small states': 3905384609.417043
Total emissions for 'Pakistan': 3644140003.3569345
Total emissions for 'Panama': 213220000.43869013
Total emissions for 'Peru': 1082419998.550415
Total emissions for 'Philippines': 2406870005.798341
Total emissions for 'Papua New Guinea': 129339999.70436095
Total emissions for 'Poland': 9427509987.792973
Total emissions for 'Pre-demographic dividend': 9276277144.682013
Total emissions for 'Korea, Dem. People's Rep.': 2000129989.6240237
Total emissions for 'Portugal': 1588619999.0844727
Total emissions for 'Paraguay': 136610000.84877014
Total emissions for 'Pacific island small states': 70741718.58012676
Total emissions for 'Post-demographic dividend': 350760303482.3914
Total emissions for 'Qatar': 1398360010.3759763
Total emissions for 'Romania': 2911399988.0981445
Total emissions for 'Russian Federation': 50028669951.171906
Total emissions for 'Rwanda': 20270000.09536743
Total emissions for 'South Asia': 45343400845.31007
Total emissions for 'Saudi Arabia': 10411920042.72461
Total emissions for 'Sudan': 332709999.0272522
Total emissions for 'Senegal': 170990000.3242493
Total emissions for 'Singapore': 1201560001.3732905
Total emissions for 'Solomon Islands': 8430000.040531162
Total emissions for 'Sierra Leone': 16709999.892711634
Total emissions for 'El Salvador': 177360000.49591056
Total emissions for 'Somalia': 18379999.940395355
Total emissions for 'Serbia': 1451359998.1689453
Total emissions for 'Sub-Saharan Africa (excluding high income)': 18032804102.318497
Total emissions for 'South Sudan': 28209999.87840655
Total emissions for 'Sub-Saharan Africa': 18043772943.966446
Total emissions for 'Small states': 5011130172.532069
Total emissions for 'Sao Tome and Principe': 2439999.9956786614
Total emissions for 'Suriname': 58950000.26226043
Total emissions for 'Slovak Republic': 1143979996.3378909
Total emissions for 'Slovenia': 443170001.83105457
Total emissions for 'Sweden': 1479820005.645752
Total emissions for 'Eswatini': 20219999.961853024
Total emissions for 'Seychelles': 10969999.896287914
Total emissions for 'Syrian Arab Republic': 1275749998.168946
Total emissions for 'Chad': 28950000.39577481
Total emissions for 'East Asia &amp; Pacific (IDA &amp; IBRD countries)': 208866163833.433
Total emissions for 'Europe &amp; Central Asia (IDA &amp; IBRD countries)': 99031617869.10379
Total emissions for 'Togo': 48429999.98092651
Total emissions for 'Thailand': 5962840003.66211
Total emissions for 'Tajikistan': 127070000.65803534
Total emissions for 'Turkmenistan': 1524150001.8310547
Total emissions for 'Latin America &amp; the Caribbean (IDA &amp; IBRD countries)': 39929189946.39128
Total emissions for 'Middle East &amp; North Africa (IDA &amp; IBRD countries)': 30220799912.348984
Total emissions for 'Tonga': 3459999.9824166265
Total emissions for 'South Asia (IDA &amp; IBRD)': 45343400845.31007
Total emissions for 'Sub-Saharan Africa (IDA &amp; IBRD countries)': 18043772943.966446
Total emissions for 'Trinidad and Tobago': 471790001.86920196
Total emissions for 'Tunisia': 688229999.6185304
Total emissions for 'Turkiye': 7610738125.918941
Total emissions for 'Tuvalu': 299999.9959766866
Total emissions for 'Tanzania': 177129998.37875354
Total emissions for 'Uganda': 75739999.98092654
Total emissions for 'Ukraine': 9787780028.076176
Total emissions for 'Upper middle income': 345819862778.84344
Total emissions for 'Uruguay': 176480000.41961676
Total emissions for 'United States': 158317880683.59372
Total emissions for 'Uzbekistan': 3472670014.038089
Total emissions for 'St. Vincent and the Grenadines': 7010000.029802322
Total emissions for 'Venezuela, RB': 4126760028.0761766
Total emissions for 'Vanuatu': 3199999.978840349
Total emissions for 'World': 812874344727.8098
Total emissions for 'Samoa': 5420000.022053717
Total emissions for 'Yemen, Rep.': 484140003.2043458
Total emissions for 'South Africa': 10590620035.40039
Total emissions for 'Zambia': 94410000.32901764
Total emissions for 'Zimbabwe': 381210002.19345087
Total emissions for 'Namibia': 78659999.79972847
Total emissions for 'Eritrea': 18240000.00357628
Total emissions for 'Micronesia, Fed. Sts.': 3870000.0005960404
Total emissions for 'Marshall Islands': 3570000.0324845244
Total emissions for 'Palau': 6159999.950528143
Total emissions for 'Timor-Leste': 6330000.028014186</code></pre>
</div>
</div>
<div id="a51694f1" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solution 2: use groupby</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>total_emissions_per_country <span class="op">=</span> df_kuznets.groupby(<span class="st">'Country Name'</span>)[<span class="st">'TEmissions'</span>].<span class="bu">sum</span>()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>total_emissions_per_country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>Country Name
Afghanistan                    9.546000e+07
Africa Eastern and Southern    1.340447e+10
Africa Western and Central     4.638752e+09
Albania                        1.125500e+08
Algeria                        3.119610e+09
                                   ...     
Venezuela, RB                  4.126760e+09
World                          8.128743e+11
Yemen, Rep.                    4.841400e+08
Zambia                         9.441000e+07
Zimbabwe                       3.812100e+08
Name: TEmissions, Length: 238, dtype: float64</code></pre>
</div>
</div>
<p><font color="blue"><strong>Question 9: Plot the evolution over time of total recorded carbon emissions (ommiting dates where no information is available).</strong></font></p>
<p>Hint: use <code>groupby()</code></p>
<div id="4b5c4c3c-8982-438a-9fcb-0b46e56e303e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>total_emissions_per_year <span class="op">=</span> df_kuznets.groupby(<span class="st">'Date'</span>)[<span class="st">'TEmissions'</span>].<span class="bu">sum</span>()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>total_emissions_per_year.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>Date
1990-01-01    1.774377e+11
1991-01-01    1.788978e+11
1992-01-01    1.788542e+11
1993-01-01    1.798608e+11
1994-01-01    1.801915e+11
Name: TEmissions, dtype: float64</code></pre>
</div>
</div>
<div id="faeb42d0" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>total_emissions_per_year.plot()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Total Carbon Emissions (world)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>Text(0.5, 1.0, 'Total Carbon Emissions (world)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="kuznets_correction_files/figure-html/cell-23-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cbf0ae05" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to get the cumulated emissions</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>total_emissions_per_year.cumsum().plot()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Cumulated Carbon Emissions (world)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>Text(0.5, 1.0, 'Cumulated Carbon Emissions (world)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="kuznets_correction_files/figure-html/cell-24-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><font color="blue"><strong>(optional) Question 10 : Propose some plots to visualize the contribution of the main contributors to yearly carbon emissions and to cumulative carbon emissions. You can get inspiration from <a href="https://ourworldindata.org/co2-emissions">ourworldindata</a>.</strong></font></p>
<p><em>We could use a pie Chart of Global Emissions by Top 10 Emitters. This plot would show us the percentage of global carbon emissions of the top 10 emitters, with each country’s contribution shown as a colored segment of a pie chart in order to provide the relative contributions of each country to global emissions.</em> <em>We could also use an area chart of cumulative emissions by top emitters: This plot shows the cumulative carbon emissions over time for the top emitters, with each country’s contribution shown as a colored area of a stacked area chart. This plot allows for easy comparison of the contributions of different countries to cumulative emissions.</em></p>
</section>
<section id="geo-analysis" class="level3">
<h3 class="anchored" data-anchor-id="geo-analysis">2.2 Geo-analysis</h3>
<div id="965982ab-b826-4cd9-94a8-3b7ff1555284" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly <span class="im">import</span> express <span class="im">as</span> px</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="total-emissions-per-country" class="level4">
<h4 class="anchored" data-anchor-id="total-emissions-per-country">2.2.1. Total emissions per country</h4>
<p><font color="blue"><strong>Question 11 : Change the following piece of code so that it represents, total emission per country (over time).</strong></font></p>
<div id="599775c1" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to replace emissions per capita by "total emissions" (`TEmissions`)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e1406eb1-7054-4813-a3de-611fb14b82aa" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>emissions_per_country<span class="op">=</span>df_kuznets[df_kuznets[<span class="st">'TEmissions'</span>].notnull()].groupby([<span class="st">"Country Name"</span>,<span class="st">"Country Code"</span>])[<span class="st">'TEmissions'</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>emissions_per_country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">TEmissions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>9.546000e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>1.340447e+10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>4.638752e+09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Albania</td>
<td>ALB</td>
<td>1.125500e+08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Algeria</td>
<td>DZA</td>
<td>3.119610e+09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">233</td>
<td>Venezuela, RB</td>
<td>VEN</td>
<td>4.126760e+09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">234</td>
<td>World</td>
<td>WLD</td>
<td>8.128743e+11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">235</td>
<td>Yemen, Rep.</td>
<td>YEM</td>
<td>4.841400e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">236</td>
<td>Zambia</td>
<td>ZMB</td>
<td>9.441000e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">237</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>3.812100e+08</td>
</tr>
</tbody>
</table>

<p>238 rows × 3 columns</p>
</div>
</div>
</div>
<div id="f998480d-5ca1-4a68-8421-63393808c149" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.choropleth(emissions_per_country, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                    locations<span class="op">=</span><span class="st">"Country Code"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span><span class="st">"TEmissions"</span>, <span class="co"># lifeExp is a column of gapminder</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                    hover_name<span class="op">=</span><span class="st">"Country Name"</span>, <span class="co"># column to add to hover information</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                    color_continuous_scale<span class="op">=</span><span class="st">'YlOrRd'</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span><span class="st">"Total Emissions per Country (1990-2019)"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>fig.update_layout(width<span class="op">=</span><span class="dv">900</span>, height<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
</section>
<section id="emission-evolution-per-country" class="level4">
<h4 class="anchored" data-anchor-id="emission-evolution-per-country">2.2.3 Emission evolution per country</h4>
<p>The following plot represents the evolution of CO2 emission per capita for various countries.</p>
<div id="288a9cf5-cae2-4575-a5bd-fec1c9fc3ea7" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Difference between the first and the last date, per country</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>evol_per_country <span class="op">=</span> df_long.groupby([<span class="st">'Country Name'</span>,<span class="st">"Country Code"</span>])[<span class="st">'Emissions'</span>].agg([<span class="st">'first'</span>, <span class="st">'last'</span>]).reset_index()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># CO2 emission evolution</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>evol_per_country[<span class="st">'Evolution'</span>] <span class="op">=</span> evol_per_country[<span class="st">'last'</span>] <span class="op">-</span> evol_per_country[<span class="st">'first'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5a851f18" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df_long[<span class="st">'Date'</span>].<span class="bu">min</span>(),df_long[<span class="st">'Date'</span>].<span class="bu">max</span>(),</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>(Timestamp('1990-01-01 00:00:00'), Timestamp('2019-01-01 00:00:00'))</code></pre>
</div>
</div>
<div id="cf1c566c-b10c-43ce-84b4-f94408a0e357" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.choropleth(evol_per_country, locations<span class="op">=</span><span class="st">"Country Code"</span>,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span><span class="st">"Evolution"</span>, <span class="co"># lifeExp is a column of gapminder</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                    hover_name<span class="op">=</span><span class="st">"Country Name"</span>, <span class="co"># column to add to hover information</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                    color_continuous_scale<span class="op">=</span><span class="st">'YlOrRd'</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span><span class="st">"Increase of Emissions per Capita (1990-2019)"</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>fig.update_layout(width<span class="op">=</span><span class="dv">900</span>, height<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
<p><font color="blue"><strong>Question 12 : Adapt the preceding piece of code so that it represents, the evolution of total emission per country.</strong></font></p>
<div id="5aeb99d3-e288-4644-96e7-44b93d5bbb17" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Difference between the first and the last date, per country</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>evol_per_country_total <span class="op">=</span> df_kuznets.groupby([<span class="st">'Country Name'</span>,<span class="st">"Country Code"</span>])[<span class="st">'TEmissions'</span>].agg([<span class="st">'first'</span>, <span class="st">'last'</span>]).reset_index()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># CO2 emission evolution</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>evol_per_country_total[<span class="st">'Evolution'</span>] <span class="op">=</span> evol_per_country_total[<span class="st">'last'</span>] <span class="op">-</span> evol_per_country_total[<span class="st">'first'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="906ce014" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.choropleth(evol_per_country_total, locations<span class="op">=</span><span class="st">"Country Code"</span>,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span><span class="st">"Evolution"</span>, <span class="co"># lifeExp is a column of gapminder</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                    hover_name<span class="op">=</span><span class="st">"Country Name"</span>, <span class="co"># column to add to hover information</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                    color_continuous_scale<span class="op">=</span><span class="st">'YlOrRd'</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span><span class="st">"Increase in total Emissions (1990-2019)"</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>fig.update_layout(width<span class="op">=</span><span class="dv">900</span>, height<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="the-kusnetz-curve" class="level2">
<h2 class="anchored" data-anchor-id="the-kusnetz-curve">3. The Kusnetz curve</h2>
<p>We are now interested in the relation between carbon emission and economic development. To this purpose, we would like to run a <em>simple</em> regression</p>
<p><span class="math display">\[\frac{ \text{emissions}_{i t} }{ \text{population}_{i t} } = \alpha + \beta*\frac{ \text{gdp}_{i t}}{\text{population}_{i t}} + \text{other factors}_{i t}\]</span></p>
<p>where <span class="math inline">\(i\)</span> is the country index and <span class="math inline">\(t\)</span> the time index. In a first step we will simply assume that the total effect of all <code>other factors</code> is normally distributed.</p>
<p>We would then like to consider variants of this regression in order to test the environment Kuznets curve hypothesis.</p>
<p><font color="blue"><strong>Question 10: Briefly summarize the environmental Kuznets curve hypothesis</strong></font></p>
<p>(hint: perform a small websearch. Try to identify your sources)</p>
<p><em>The Environmental Kuznets Curve hypothesis postulates an inverted-U-shaped relationship between different pollutants and per capita income, i.e., environmental pressure increases up to a certain level as income goes up; after that, it decreases. The environmental pollution increases at the beginning of economic growth. However, when it passes a certain level of income, the economic growth allows environmental remediation.</em> from Environmental Kuznets Curve: The Evidence from BSEC Countries* - / EGE ACADEMIC REVIEW and “Environmental Kuznets Curve Hypothesis: A Survey” from Ecological Economics</p>
<p><font color="blue"><strong>Question 11: Regress per capita emissions on gdp per capita and comment.</strong></font></p>
<div id="44344fef-03d9-4e6a-b675-6c3584855b29" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula <span class="im">import</span> api <span class="im">as</span> smf</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df_kuznets[<span class="st">'GDP_per_capita'</span>]<span class="op">=</span>df_kuznets[<span class="st">'GDP'</span>]<span class="op">/</span><span class="dv">1000</span><span class="op">/</span>df_kuznets[<span class="st">'Population'</span>]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#on divise le PIB par mille car c'est en million et la population est en milliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5df2a563" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>model<span class="op">=</span>smf.ols(<span class="st">" Emissions ~ GDP_per_capita "</span>, df_kuznetz)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>res<span class="op">=</span>model.fit()</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>res.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>The estimated regresssion is <code>emissions per capita = 2,45+ 0,1852 gdp per capita</code>. Both the intercept and the coefficient are significant, indicating that higher GDP per capita is associated with higher per capita emissions, holding other factors constant. The R-squared of the model is relatively low at 0.334, suggesting that other factors not included in the model may also be important in explaining per capita emissions.</em></p>
<p><font color="blue"><strong>Question 12: Split the sample into the three quantiles, based on gdp/capita in the last period. Run the same regression in all three subsamples. Comment.</strong></font></p>
<div id="2c287624-329f-4402-a8f3-245322089d03" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df_kuznets[<span class="st">'Quantile'</span>]<span class="op">=</span> pd.qcut(df_kuznets[<span class="st">'GDP_per_capita'</span>],q <span class="op">=</span> <span class="dv">3</span>, labels<span class="op">=</span>[<span class="st">'low'</span>, <span class="st">'medium'</span>, <span class="st">'high'</span>])</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>model_low<span class="op">=</span>smf.ols(<span class="st">" Emissions ~ GDP_per_capita "</span>, df_kuznets[df_kuznets[<span class="st">'Quantile'</span>] <span class="op">==</span> <span class="st">"low"</span>])</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>res_low<span class="op">=</span>model_low.fit()</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>res_low.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.080</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.080</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>200.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Sun, 07 Apr 2024</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>1.27e-43</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>23:03:16</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-4015.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>2303</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>8035.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>2301</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>8046.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>0.0768</td>
<td>0.064</td>
<td>1.205</td>
<td>0.228</td>
<td>-0.048</td>
<td>0.202</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>1.1274</td>
<td>0.080</td>
<td>14.145</td>
<td>0.000</td>
<td>0.971</td>
<td>1.284</td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>1826.266</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.594</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>34369.056</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>3.736</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>20.388</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>4.30</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div id="946aeab3" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>model_medium<span class="op">=</span>smf.ols(<span class="st">" Emissions ~ GDP_per_capita "</span>, df_kuznets[df_kuznets[<span class="st">'Quantile'</span>] <span class="op">==</span> <span class="st">"medium"</span>])</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>res_medium<span class="op">=</span>model_medium.fit()</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>res_medium.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.093</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.093</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>236.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Sun, 07 Apr 2024</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>8.79e-51</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>23:03:47</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-5186.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>2299</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>1.038e+04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>2297</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>1.039e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>1.1684</td>
<td>0.124</td>
<td>9.443</td>
<td>0.000</td>
<td>0.926</td>
<td>1.411</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>0.5272</td>
<td>0.034</td>
<td>15.364</td>
<td>0.000</td>
<td>0.460</td>
<td>0.594</td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>922.711</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.907</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>3721.972</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>1.961</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>7.844</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>9.87</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div id="7fc66491" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>model_high<span class="op">=</span>smf.ols(<span class="st">" Emissions ~ GDP_per_capita "</span>, df_kuznets[df_kuznets[<span class="st">'Quantile'</span>] <span class="op">==</span> <span class="st">"high"</span>])</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>res_high<span class="op">=</span>model_high.fit()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>res_high.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.077</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.077</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>192.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Sun, 07 Apr 2024</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>4.44e-42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>23:04:03</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-7386.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>2302</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>1.478e+04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>2300</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>1.479e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>6.8578</td>
<td>0.194</td>
<td>35.438</td>
<td>0.000</td>
<td>6.478</td>
<td>7.237</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>0.0824</td>
<td>0.006</td>
<td>13.872</td>
<td>0.000</td>
<td>0.071</td>
<td>0.094</td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>1125.974</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.959</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>7949.756</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>2.210</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>10.958</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>50.5</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<p><em>These three linear regressions show us that the higher the GDP per capita of countries, the higher the R-squared. This means that the model is more predictive for countries with a “high” GDP, the higher their GDP per capita, the higher their per capita emissions. This partly confirms the Kuznetz curve hypothesis</em></p>
<p><font color="blue"><strong>Question 13. Instead of splitting the sample, run a nonlinear regression:</strong></font></p>
<p><span class="math display">\[\frac{ \text{emissions}_{i t} }{ \text{population}_{i t} } = \alpha + \beta_1*\frac{ \text{gdp}_{i t}}{\text{population}_{i t}} + \beta_2*\left( \frac{ \text{gdp}_{i t}}{\text{population}_{i t}} \right)^2 + \text{other factors}_{i t}\]</span></p>
<p>Justify why <span class="math inline">\(\beta_2&lt;0\)</span> can be interpreted as a proof of the environmental Kuznets hypothesis. Comment.</p>
<div id="ff66d4c5-352d-4109-a569-3214439eab83" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>nonlinear_regression<span class="op">=</span>smf.ols(<span class="st">'Emissions ~ GDP_per_capita + np.power(GDP_per_capita, 2)'</span>,df_kuznets)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>res_nl<span class="op">=</span>nonlinear_regression.fit()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>res_nl.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.465</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>2997.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Sun, 07 Apr 2024</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>23:04:36</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-19043.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>6904</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>3.809e+04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>6901</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>3.811e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>2</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>1.5058</td>
<td>0.058</td>
<td>25.901</td>
<td>0.000</td>
<td>1.392</td>
<td>1.620</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>0.3718</td>
<td>0.005</td>
<td>69.641</td>
<td>0.000</td>
<td>0.361</td>
<td>0.382</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">np.power(GDP_per_capita, 2)</td>
<td>-0.0024</td>
<td>5.77e-05</td>
<td>-41.234</td>
<td>0.000</td>
<td>-0.002</td>
<td>-0.002</td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>4635.223</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.906</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>102447.422</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>2.899</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>20.959</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>1.96e+03</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[2] The condition number is large, 1.96e+03. This might indicate that there are<br>strong multicollinearity or other numerical problems.
</div>
</div>
<p><em>The coefficient on the quadratic term, 𝛽2, is negative, standing at -0,0024, which support the hypothesis that the relationship between emissions and GDP per capita is U-shaped and consistent with the EKH.</em></p>
<p><strong>(Bonus) Suggest a way to improve the regression.</strong></p>
<p><em>this result alone does not provide conclusive proof of the EKH, as the coefficient is not statistically significant and as there may be other factors that influence the relationship between emissions and GDP per capita</em></p>


</section>

</font></main><font color="blue"> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/albop\.github\.io\/dbe\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</font></div><font color="blue"> <!-- /content -->




</font></body></html>