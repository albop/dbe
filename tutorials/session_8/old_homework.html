<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data-Based Economics - Data-Based Economics: Coursework</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      Data-Based Economics
      </li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Data-Based Economics</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataframes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_3/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_4/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_5/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Instrumental Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_6/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Machine Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_7/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Machine Learning (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_8/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/session_10/index_handout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Some Important Points</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/session_3/Phillips_curve_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualizing the Philips Curve</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/session_4/Regressions_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(Multiple) Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/session_5/instrumental_variables_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrumental variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/session_6/machine_learning_regressions_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine learning: regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/session_7/Classification_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classification and clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/session_8/sentiment_analysis_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confusion Matrix and Sentiment Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/session_9/kuznets_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CO2 Emissions and the Kusnetz curve</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">pushups</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../pushups/pushups_1_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics and Collections</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../pushups/pushups_3_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sparse regression with sklearn</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-based-economics-coursework" id="toc-data-based-economics-coursework" class="nav-link active" data-scroll-target="#data-based-economics-coursework">Data-Based Economics: Coursework</a>
  <ul class="collapse">
  <li><a href="#co2-emissions-and-the-kusnetz-curve" id="toc-co2-emissions-and-the-kusnetz-curve" class="nav-link" data-scroll-target="#co2-emissions-and-the-kusnetz-curve">CO2 Emissions and the Kusnetz curve</a>
  <ul class="collapse">
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data">Importing the data</a></li>
  <li><a href="#cleaning-up" id="toc-cleaning-up" class="nav-link" data-scroll-target="#cleaning-up">Cleaning up</a></li>
  <li><a href="#graphical-representation" id="toc-graphical-representation" class="nav-link" data-scroll-target="#graphical-representation">Graphical representation</a></li>
  <li><a href="#the-kusnetz-curve" id="toc-the-kusnetz-curve" class="nav-link" data-scroll-target="#the-kusnetz-curve">The Kusnetz curve</a></li>
  </ul></li>
  <li><a href="#predicting-booking-cancellations" id="toc-predicting-booking-cancellations" class="nav-link" data-scroll-target="#predicting-booking-cancellations">Predicting booking cancellations</a>
  <ul class="collapse">
  <li><a href="#preparation" id="toc-preparation" class="nav-link" data-scroll-target="#preparation">Preparation</a></li>
  <li><a href="#training" id="toc-training" class="nav-link" data-scroll-target="#training">Training</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation">Validation</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data-Based Economics: Coursework</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-based-economics-coursework" class="level1">
<h1>Data-Based Economics: Coursework</h1>
<p>Students (up to 3):</p>
<ul>
<li>x1 Gabrielle Labat</li>
<li>x2 Manal Bendjedid</li>
</ul>
<p>When working on the questions below, don‚Äôt hesitate to take some initiatives. In particular, if you don‚Äôt find how to answer a particular question (and you have asked üòâ), feel free to propose a workaround.</p>
<p>Your work will be evaluated in the following dimensions:</p>
<ol type="1">
<li>Whether your notebook is replicable. When grading it, I should be able to run it from start to finish without error.</li>
<li>Whether it is well written and clear. There should always be legible text to explain what you do, and make it a nice read. Imagine that the document was meant to be published as an online tutorial.</li>
<li>Whether you have successfully solved the various theoretical and practical problems that are asked below.</li>
<li>Whether you have shown some sense of initiative in approaching the various problems, in making the plots or in proposing extensions.</li>
</ol>
<section id="co2-emissions-and-the-kusnetz-curve" class="level2">
<h2 class="anchored" data-anchor-id="co2-emissions-and-the-kusnetz-curve">CO2 Emissions and the Kusnetz curve</h2>
<p>In this exercise, you must use data from the WorldBank to check whether CO2 Emissions can be explained by income per capita.</p>
<section id="importing-the-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-data">Importing the data</h3>
<p><strong>Import the data from file <code>data/API_EN.ATM.CO2E.PC_DS2_en_csv_v2_5177406.csv</code> as a dataframe <code>df_wide</code>. (This table was downloaded from the worldbank website)</strong></p>
<p>Hints: check the documentation from <code>pandas.read_csv()</code> to avoid the import error. You can check the first few lines of the file by typing in a cell: <code>!data/API_EN.ATM.CO2E.PC_DS2_en_csv_v2_5177406.csv</code></p>
<p>Hint2: Check that all columns are well defined.</p>
<div id="ddca6bcf-10f4-4922-89c3-0e193a84d9dc" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df_wide <span class="op">=</span> pd.read_csv(<span class="st">'data/API_EN.ATM.CO2E.PC_DS2_en_csv_v2_5177406.csv'</span>, skiprows<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>data<span class="op">/</span>API_EN.ATM.CO2E.PC_DS2_en_csv_v2_5177406.csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/bin/bash: line 1: data/API_EN.ATM.CO2E.PC_DS2_en_csv_v2_5177406.csv: Permission denied</code></pre>
</div>
</div>
<p><strong>Describe briefly the data.</strong></p>
<p><em>The data contains information on the level of carbon dioxide (CO2) emissions per capita (in metric tons) for different countries and regions over the years 1960 to 2019. The data is sourced from the World Bank‚Äôs World Development Indicators and is reported annually.</em></p>
<p><em>The dataset contains 264 rows (corresponding to different countries and regions) and 61 columns (corresponding to the years 1960 to 2019 and additional columns with country and region information). The data is in a wide format, with each row representing a country/region and each column representing a year.</em></p>
<p><em>The data is useful for analyzing trends in CO2 emissions over time and comparing emissions across countries and regions. It can also be used for exploring the relationship between CO2 emissions and various economic and environmental factors.</em></p>
<div id="c618b2c1-f16f-4950-a210-b8d1c046daff" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_wide.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1960</th>
<th data-quarto-table-cell-role="th">1961</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1963</th>
<th data-quarto-table-cell-role="th">1964</th>
<th data-quarto-table-cell-role="th">1965</th>
<th data-quarto-table-cell-role="th">1966</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1968</th>
<th data-quarto-table-cell-role="th">1969</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">2013</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2020</th>
<th data-quarto-table-cell-role="th">2021</th>
<th data-quarto-table-cell-role="th">Unnamed: 66</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>239.000000</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>4.288766</td>
<td>4.194242</td>
<td>4.141210</td>
<td>4.140690</td>
<td>4.148584</td>
<td>4.128191</td>
<td>4.086604</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>5.002821</td>
<td>4.862196</td>
<td>4.731198</td>
<td>4.653372</td>
<td>4.585664</td>
<td>4.489473</td>
<td>4.474616</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.024987</td>
<td>0.027090</td>
<td>0.037289</td>
<td>0.029718</td>
<td>0.033815</td>
<td>0.035826</td>
<td>0.035704</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.720891</td>
<td>0.785259</td>
<td>0.771880</td>
<td>0.769068</td>
<td>0.802179</td>
<td>0.797275</td>
<td>0.790333</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>2.726281</td>
<td>2.888558</td>
<td>2.827949</td>
<td>2.760181</td>
<td>2.699348</td>
<td>2.979403</td>
<td>2.981762</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>6.264131</td>
<td>6.028664</td>
<td>5.792812</td>
<td>5.828931</td>
<td>6.021844</td>
<td>5.950694</td>
<td>5.890683</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>37.420762</td>
<td>36.875726</td>
<td>35.111798</td>
<td>33.493040</td>
<td>32.281678</td>
<td>31.235406</td>
<td>32.761775</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>8 rows √ó 63 columns</p>
</div>
</div>
</div>
</section>
<section id="cleaning-up" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-up">Cleaning up</h3>
<p><strong>Convert the data into the long format using the function <code>pandas.melt()</code>. The columns of the new table <code>df_long</code> should be: <code>["Country Name","Country Code","Indicator Name","Indicator Code", "Date", "Emissions"]</code></strong></p>
<div id="a89176f8-aa96-49e8-bf47-ff5d3ef88a32" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_long<span class="op">=</span>pd.melt(df_wide,id_vars<span class="op">=</span>[<span class="st">"Country Name"</span>,<span class="st">"Country Code"</span>,<span class="st">"Indicator Name"</span>,<span class="st">"Indicator Code"</span>],var_name<span class="op">=</span><span class="st">"Date"</span>,value_name<span class="op">=</span> <span class="st">"Emissions"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Emissions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Aruba</td>
<td>ABW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1960</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1960</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1960</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1960</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Angola</td>
<td>AGO</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1960</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16753</td>
<td>Kosovo</td>
<td>XKX</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>Unnamed: 66</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16754</td>
<td>Yemen, Rep.</td>
<td>YEM</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>Unnamed: 66</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16755</td>
<td>South Africa</td>
<td>ZAF</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>Unnamed: 66</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16756</td>
<td>Zambia</td>
<td>ZMB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>Unnamed: 66</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16757</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>Unnamed: 66</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>16758 rows √ó 6 columns</p>
</div>
</div>
</div>
<p><strong>Eliminate all rows for which no emission data is available</strong></p>
<div id="70057e0b-bc95-44e5-a2b8-81be72ec3f96" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_long.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Emissions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7981</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.982136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7982</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.222538</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7983</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.473669</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7984</td>
<td>Angola</td>
<td>AGO</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.554586</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7985</td>
<td>Albania</td>
<td>ALB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>1.819542</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15954</td>
<td>Samoa</td>
<td>WSM</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>1.415729</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15956</td>
<td>Yemen, Rep.</td>
<td>YEM</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>0.351859</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15957</td>
<td>South Africa</td>
<td>ZAF</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>7.568640</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15958</td>
<td>Zambia</td>
<td>ZMB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>0.369958</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15959</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>0.765894</td>
</tr>
</tbody>
</table>

<p>7147 rows √ó 6 columns</p>
</div>
</div>
</div>
<p><strong>Convert the <code>Date</code> column into a date format.</strong></p>
<p><em>Hint: look for pandas.to_datetime() (This is not absolutely mandatory but makes graphs nicer)</em></p>
<div id="229a0cc1-3a10-4b6c-8600-fc812797e7fc" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_long[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(df_long[<span class="st">'Date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_long[<span class="st">'Date'</span>].dtype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: time data 'Unnamed: 66' does not match format '%Y' (match)</code></pre>
</div>
</div>
</section>
<section id="graphical-representation" class="level3">
<h3 class="anchored" data-anchor-id="graphical-representation">Graphical representation</h3>
<p><strong>Plot the evolution over time of total recorded carbon emissions (ommiting dates where no information is available).</strong></p>
<p>Hint: use <code>groupby()</code></p>
<div id="0468ef39-de85-4459-a494-88953304ced1" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>total_emissions<span class="op">=</span>df_long[df_long[<span class="st">'Emissions'</span>].notnull()].groupby(df_long[<span class="st">'Date'</span>])[<span class="st">'Emissions'</span>].<span class="bu">sum</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>total_emissions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Date
1990     992.579902
1991     971.488470
1992     971.204768
1993     955.914952
1994     949.595751
1995     948.978410
1996     964.076804
1997     970.839153
1998     970.257143
1999     964.693322
2000     967.857097
2001     984.230281
2002     993.251894
2003    1022.691228
2004    1038.318099
2005    1048.812274
2006    1064.012494
2007    1060.075753
2008    1053.788436
2009    1069.598447
2010    1033.216694
2011    1037.102602
2012    1047.851826
2013    1025.015035
2014    1002.423899
2015     989.749130
2016     989.624913
2017     991.511483
2018     986.637647
2019     976.698404
Name: Emissions, dtype: float64</code></pre>
</div>
</div>
<div id="543152e9-f89c-427f-99cc-f23e808fab3a" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plt.plot(total_emissions)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Years"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Emissions as metric tons per capita"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Evolution of total CO2 emissions over time"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>plt.show</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="old_homework_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Plot cumulative carbon emissions</strong></p>
<div id="85fd41aa-3cc8-4230-bc07-700a50b44718" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plt.plot(total_emissions.cumsum())</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Years"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Emissions as metric tons per capita"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Evolution of cumulated CO2 emissions over time"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>plt.show</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="old_homework_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Propose some plots to visualize the contribution of the main contributors to yearly carbon emissions and to cumulative carbon emissions. You can get inspiration from <a href="https://ourworldindata.org/co2-emissions">ourworldindata</a>.</strong></p>
<p><em>We could use a pie Chart of Global Emissions by Top 10 Emitters. This plot would show us the percentage of global carbon emissions of the top 10 emitters, with each country‚Äôs contribution shown as a colored segment of a pie chart in order to provide the relative contributions of each country to global emissions.</em> <em>We could also use an area chart of cumulative emissions by top emitters: This plot shows the cumulative carbon emissions over time for the top emitters, with each country‚Äôs contribution shown as a colored area of a stacked area chart. This plot allows for easy comparison of the contributions of different countries to cumulative emissions.</em></p>
</section>
<section id="the-kusnetz-curve" class="level3">
<h3 class="anchored" data-anchor-id="the-kusnetz-curve">The Kusnetz curve</h3>
<p>We are now interested in the relation between carbon emission and economic development. To this purpose, we would like to run a <em>simple</em> regression</p>
<p><span class="math display">\[\frac{ \text{emissions}_{i t} }{ \text{population}_{i t} } = \alpha + \beta*\frac{ \text{gdp}_{i t}}{\text{population}_{i t}} + \text{other factors}_{i t}\]</span></p>
<p>where <span class="math inline">\(i\)</span> is the country index and <span class="math inline">\(t\)</span> the time index. In a first step we will simply assume that the total effect of all <code>other factors</code> is normally distributed.</p>
<p>We would then like to consider variants of this regression in order to test the environment Kuznets curve hypothesis.</p>
<p><strong>Briefly summarize the environmental Kuznets curve hypothesis</strong></p>
<p>(hint: perform a small websearch. Try to identify your sources)</p>
<p><em>The Environmental Kuznets Curve hypothesis postulates an inverted-U-shaped relationship between different pollutants and per capita income, i.e., environmental pressure increases up to a certain level as income goes up; after that, it decreases. The environmental pollution increases at the beginning of economic growth. However, when it passes a certain level of income, the economic growth allows environmental remediation.</em> from Environmental Kuznets Curve: The Evidence from BSEC Countries* - / EGE ACADEMIC REVIEW and ‚ÄúEnvironmental Kuznets Curve Hypothesis: A Survey‚Äù from Ecological Economics</p>
<p><strong>Prepare the data</strong></p>
<p>From the world bank website, download data for historical real gdp and population.</p>
<p>Perform the same steps as in the first part for both series then <code>merge</code> the resulting long databases ‚Äúon‚Äù the <code>Country Code</code> and <code>Date</code> columns.</p>
<p>You should obtain one single database <code>data</code> containing the columns <code>["Country Name","Country Code","Indicator Name","Indicator Code","Date", "Emissions", "GDP", "Population"]</code></p>
<div id="fbfd71f0-9604-4961-a857-cc85996bd9ce" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_gdp <span class="op">=</span> pd.read_csv(<span class="st">'data/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_5358352.csv'</span>, skiprows<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df_gdp.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1960</th>
<th data-quarto-table-cell-role="th">1961</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1963</th>
<th data-quarto-table-cell-role="th">1964</th>
<th data-quarto-table-cell-role="th">1965</th>
<th data-quarto-table-cell-role="th">1966</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1968</th>
<th data-quarto-table-cell-role="th">1969</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">2013</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2020</th>
<th data-quarto-table-cell-role="th">2021</th>
<th data-quarto-table-cell-role="th">Unnamed: 66</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1.340000e+02</td>
<td>1.360000e+02</td>
<td>1.380000e+02</td>
<td>1.380000e+02</td>
<td>1.380000e+02</td>
<td>1.490000e+02</td>
<td>1.520000e+02</td>
<td>1.550000e+02</td>
<td>1.600000e+02</td>
<td>1.600000e+02</td>
<td>...</td>
<td>2.590000e+02</td>
<td>2.600000e+02</td>
<td>2.580000e+02</td>
<td>2.570000e+02</td>
<td>2.570000e+02</td>
<td>2.570000e+02</td>
<td>2.550000e+02</td>
<td>2.520000e+02</td>
<td>2.450000e+02</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>7.103309e+10</td>
<td>7.186603e+10</td>
<td>7.549842e+10</td>
<td>8.144478e+10</td>
<td>8.941392e+10</td>
<td>9.084572e+10</td>
<td>1.010890e+11</td>
<td>1.048751e+11</td>
<td>1.100032e+11</td>
<td>1.216457e+11</td>
<td>...</td>
<td>2.477220e+12</td>
<td>2.538873e+12</td>
<td>2.400201e+12</td>
<td>2.444669e+12</td>
<td>2.619922e+12</td>
<td>2.783541e+12</td>
<td>2.845284e+12</td>
<td>2.790295e+12</td>
<td>3.276616e+12</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2.132401e+11</td>
<td>2.208573e+11</td>
<td>2.354226e+11</td>
<td>2.532708e+11</td>
<td>2.769939e+11</td>
<td>2.909741e+11</td>
<td>3.185999e+11</td>
<td>3.369853e+11</td>
<td>3.589008e+11</td>
<td>3.950250e+11</td>
<td>...</td>
<td>8.385432e+12</td>
<td>8.597524e+12</td>
<td>8.158733e+12</td>
<td>8.314435e+12</td>
<td>8.847933e+12</td>
<td>9.417930e+12</td>
<td>9.586893e+12</td>
<td>9.387492e+12</td>
<td>1.079655e+13</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>1.201201e+07</td>
<td>1.159201e+07</td>
<td>9.122751e+06</td>
<td>1.084010e+07</td>
<td>1.271247e+07</td>
<td>1.359393e+07</td>
<td>1.446908e+07</td>
<td>1.583518e+07</td>
<td>1.460000e+07</td>
<td>1.585000e+07</td>
<td>...</td>
<td>3.861749e+07</td>
<td>3.875969e+07</td>
<td>3.681166e+07</td>
<td>4.162950e+07</td>
<td>4.521766e+07</td>
<td>4.781829e+07</td>
<td>5.422315e+07</td>
<td>5.505471e+07</td>
<td>6.310096e+07</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>5.151683e+08</td>
<td>5.215510e+08</td>
<td>5.354690e+08</td>
<td>5.336845e+08</td>
<td>5.526379e+08</td>
<td>5.929812e+08</td>
<td>6.427026e+08</td>
<td>6.264909e+08</td>
<td>6.454036e+08</td>
<td>6.912229e+08</td>
<td>...</td>
<td>8.488220e+09</td>
<td>9.029027e+09</td>
<td>8.589120e+09</td>
<td>8.595956e+09</td>
<td>9.252834e+09</td>
<td>9.880676e+09</td>
<td>1.088080e+10</td>
<td>1.016305e+10</td>
<td>1.226939e+10</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>2.976974e+09</td>
<td>2.966849e+09</td>
<td>3.050700e+09</td>
<td>3.570681e+09</td>
<td>3.432183e+09</td>
<td>3.120871e+09</td>
<td>3.549759e+09</td>
<td>3.384063e+09</td>
<td>4.064739e+09</td>
<td>4.759106e+09</td>
<td>...</td>
<td>5.094967e+10</td>
<td>5.339963e+10</td>
<td>4.966795e+10</td>
<td>4.984049e+10</td>
<td>5.472660e+10</td>
<td>5.700369e+10</td>
<td>6.113687e+10</td>
<td>5.715932e+10</td>
<td>6.740429e+10</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>2.976519e+10</td>
<td>2.822553e+10</td>
<td>2.788859e+10</td>
<td>3.229580e+10</td>
<td>2.974366e+10</td>
<td>2.834471e+10</td>
<td>2.947510e+10</td>
<td>3.076382e+10</td>
<td>3.420277e+10</td>
<td>3.741948e+10</td>
<td>...</td>
<td>5.373933e+11</td>
<td>5.478617e+11</td>
<td>5.020845e+11</td>
<td>5.156547e+11</td>
<td>5.492678e+11</td>
<td>5.554554e+11</td>
<td>5.700678e+11</td>
<td>6.254289e+11</td>
<td>8.190352e+11</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.392273e+12</td>
<td>1.448622e+12</td>
<td>1.550544e+12</td>
<td>1.671610e+12</td>
<td>1.830287e+12</td>
<td>1.993900e+12</td>
<td>2.163894e+12</td>
<td>2.302529e+12</td>
<td>2.485213e+12</td>
<td>2.741172e+12</td>
<td>...</td>
<td>7.760623e+13</td>
<td>7.973264e+13</td>
<td>7.518636e+13</td>
<td>7.646936e+13</td>
<td>8.140950e+13</td>
<td>8.646696e+13</td>
<td>8.765425e+13</td>
<td>8.511634e+13</td>
<td>9.652743e+13</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>8 rows √ó 63 columns</p>
</div>
</div>
</div>
<div id="3ca91634-34c8-40f6-a413-e50c51f3c223" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df_pop<span class="op">=</span>pd.read_csv(<span class="st">'data/API_SP.POP.TOTL_DS2_en_csv_v2_5358404.csv'</span>, skiprows<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_pop.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1960</th>
<th data-quarto-table-cell-role="th">1961</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1963</th>
<th data-quarto-table-cell-role="th">1964</th>
<th data-quarto-table-cell-role="th">1965</th>
<th data-quarto-table-cell-role="th">1966</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1968</th>
<th data-quarto-table-cell-role="th">1969</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">2013</th>
<th data-quarto-table-cell-role="th">2014</th>
<th data-quarto-table-cell-role="th">2015</th>
<th data-quarto-table-cell-role="th">2016</th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
<th data-quarto-table-cell-role="th">2020</th>
<th data-quarto-table-cell-role="th">2021</th>
<th data-quarto-table-cell-role="th">Unnamed: 66</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>2.640000e+02</td>
<td>...</td>
<td>2.650000e+02</td>
<td>2.650000e+02</td>
<td>2.650000e+02</td>
<td>2.650000e+02</td>
<td>2.650000e+02</td>
<td>2.650000e+02</td>
<td>2.650000e+02</td>
<td>2.650000e+02</td>
<td>2.650000e+02</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>1.172187e+08</td>
<td>1.188268e+08</td>
<td>1.209957e+08</td>
<td>1.236763e+08</td>
<td>1.263792e+08</td>
<td>1.291211e+08</td>
<td>1.319789e+08</td>
<td>1.348350e+08</td>
<td>1.377713e+08</td>
<td>1.408128e+08</td>
<td>...</td>
<td>2.925870e+08</td>
<td>2.964856e+08</td>
<td>3.003545e+08</td>
<td>3.042155e+08</td>
<td>3.080704e+08</td>
<td>3.118393e+08</td>
<td>3.155191e+08</td>
<td>3.190983e+08</td>
<td>3.223248e+08</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>3.693371e+08</td>
<td>3.738947e+08</td>
<td>3.806132e+08</td>
<td>3.893042e+08</td>
<td>3.980380e+08</td>
<td>4.069033e+08</td>
<td>4.162308e+08</td>
<td>4.255158e+08</td>
<td>4.350875e+08</td>
<td>4.450496e+08</td>
<td>...</td>
<td>9.184860e+08</td>
<td>9.299558e+08</td>
<td>9.412781e+08</td>
<td>9.525129e+08</td>
<td>9.637185e+08</td>
<td>9.745580e+08</td>
<td>9.850384e+08</td>
<td>9.950997e+08</td>
<td>1.004098e+09</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>2.646000e+03</td>
<td>2.888000e+03</td>
<td>3.171000e+03</td>
<td>3.481000e+03</td>
<td>3.811000e+03</td>
<td>4.161000e+03</td>
<td>4.531000e+03</td>
<td>4.930000e+03</td>
<td>5.354000e+03</td>
<td>5.646000e+03</td>
<td>...</td>
<td>1.069400e+04</td>
<td>1.089900e+04</td>
<td>1.087700e+04</td>
<td>1.085200e+04</td>
<td>1.082800e+04</td>
<td>1.086500e+04</td>
<td>1.095600e+04</td>
<td>1.106900e+04</td>
<td>1.120400e+04</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>5.132212e+05</td>
<td>5.231345e+05</td>
<td>5.337595e+05</td>
<td>5.449288e+05</td>
<td>5.566630e+05</td>
<td>5.651150e+05</td>
<td>5.691470e+05</td>
<td>5.773872e+05</td>
<td>5.832700e+05</td>
<td>5.875942e+05</td>
<td>...</td>
<td>1.697753e+06</td>
<td>1.743309e+06</td>
<td>1.788196e+06</td>
<td>1.777557e+06</td>
<td>1.791003e+06</td>
<td>1.797085e+06</td>
<td>1.788878e+06</td>
<td>1.790133e+06</td>
<td>1.786038e+06</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>3.757486e+06</td>
<td>3.887144e+06</td>
<td>4.023896e+06</td>
<td>4.139356e+06</td>
<td>4.224612e+06</td>
<td>4.277636e+06</td>
<td>4.331825e+06</td>
<td>4.385700e+06</td>
<td>4.450934e+06</td>
<td>4.530800e+06</td>
<td>...</td>
<td>1.014958e+07</td>
<td>1.028212e+07</td>
<td>1.035808e+07</td>
<td>1.032545e+07</td>
<td>1.030030e+07</td>
<td>1.039533e+07</td>
<td>1.044767e+07</td>
<td>1.060623e+07</td>
<td>1.050577e+07</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>2.670606e+07</td>
<td>2.748694e+07</td>
<td>2.830289e+07</td>
<td>2.914708e+07</td>
<td>3.001684e+07</td>
<td>3.084892e+07</td>
<td>3.163010e+07</td>
<td>3.209247e+07</td>
<td>3.249927e+07</td>
<td>3.277149e+07</td>
<td>...</td>
<td>6.023395e+07</td>
<td>6.078914e+07</td>
<td>6.073058e+07</td>
<td>6.062750e+07</td>
<td>6.053671e+07</td>
<td>6.042176e+07</td>
<td>5.987258e+07</td>
<td>6.170452e+07</td>
<td>6.358833e+07</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>3.031565e+09</td>
<td>3.072511e+09</td>
<td>3.126935e+09</td>
<td>3.193509e+09</td>
<td>3.260518e+09</td>
<td>3.328285e+09</td>
<td>3.398561e+09</td>
<td>3.468457e+09</td>
<td>3.540255e+09</td>
<td>3.614669e+09</td>
<td>...</td>
<td>7.229185e+09</td>
<td>7.317509e+09</td>
<td>7.404911e+09</td>
<td>7.491934e+09</td>
<td>7.578158e+09</td>
<td>7.661776e+09</td>
<td>7.742682e+09</td>
<td>7.820982e+09</td>
<td>7.888409e+09</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>8 rows √ó 63 columns</p>
</div>
</div>
</div>
<div id="f4e4d23d-a923-4035-bc20-145694449b9e" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df2_long<span class="op">=</span>pd.melt(df_gdp,id_vars<span class="op">=</span>[<span class="st">"Country Name"</span>,<span class="st">"Country Code"</span>,<span class="st">"Indicator Name"</span>,<span class="st">"Indicator Code"</span>],var_name<span class="op">=</span><span class="st">"Date"</span>,value_name<span class="op">=</span> <span class="st">"GDP"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df2_long.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">GDP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>1960</td>
<td>2.129152e+10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>1960</td>
<td>5.377778e+08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>1960</td>
<td>1.040414e+10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Australia</td>
<td>AUS</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>1960</td>
<td>1.860567e+10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Austria</td>
<td>AUT</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>1960</td>
<td>6.592694e+09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16486</td>
<td>Samoa</td>
<td>WSM</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2021</td>
<td>8.438424e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16487</td>
<td>Kosovo</td>
<td>XKX</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2021</td>
<td>9.412034e+09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16489</td>
<td>South Africa</td>
<td>ZAF</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2021</td>
<td>4.190150e+11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16490</td>
<td>Zambia</td>
<td>ZMB</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2021</td>
<td>2.214763e+10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16491</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2021</td>
<td>2.837124e+10</td>
</tr>
</tbody>
</table>

<p>13156 rows √ó 6 columns</p>
</div>
</div>
</div>
<div id="7652c394-a4aa-44e3-859b-6833480e724e" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df3_long<span class="op">=</span>pd.melt(df_pop,id_vars<span class="op">=</span>[<span class="st">"Country Name"</span>,<span class="st">"Country Code"</span>,<span class="st">"Indicator Name"</span>,<span class="st">"Indicator Code"</span>],var_name<span class="op">=</span><span class="st">"Date"</span>,value_name<span class="op">=</span> <span class="st">"Population"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df3_long.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Aruba</td>
<td>ABW</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>1960</td>
<td>54608.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>1960</td>
<td>130692579.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Afghanistan</td>
<td>AFG</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>1960</td>
<td>8622466.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>1960</td>
<td>97256290.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Angola</td>
<td>AGO</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>1960</td>
<td>5357195.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16487</td>
<td>Kosovo</td>
<td>XKX</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>2021</td>
<td>1786038.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16488</td>
<td>Yemen, Rep.</td>
<td>YEM</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>2021</td>
<td>32981641.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16489</td>
<td>South Africa</td>
<td>ZAF</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>2021</td>
<td>59392255.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16490</td>
<td>Zambia</td>
<td>ZMB</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>2021</td>
<td>19473125.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16491</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>2021</td>
<td>15993524.0</td>
</tr>
</tbody>
</table>

<p>16400 rows √ó 6 columns</p>
</div>
</div>
</div>
<div id="42b9fc96-9f39-43e7-a068-3aa24027debb" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_kuznetz<span class="op">=</span> df_long.merge(df2_long,on<span class="op">=</span>[<span class="st">"Date"</span>,<span class="st">"Country Name"</span>,<span class="st">"Country Code"</span>]).merge(df3_long, on<span class="op">=</span>[<span class="st">"Date"</span>,<span class="st">"Country Name"</span>,<span class="st">"Country Code"</span>])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df_kuznetz.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country Name</th>
<th data-quarto-table-cell-role="th">Country Code</th>
<th data-quarto-table-cell-role="th">Indicator Name_x</th>
<th data-quarto-table-cell-role="th">Indicator Code_x</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Emissions</th>
<th data-quarto-table-cell-role="th">Indicator Name_y</th>
<th data-quarto-table-cell-role="th">Indicator Code_y</th>
<th data-quarto-table-cell-role="th">GDP</th>
<th data-quarto-table-cell-role="th">Indicator Name</th>
<th data-quarto-table-cell-role="th">Indicator Code</th>
<th data-quarto-table-cell-role="th">Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7981</td>
<td>Africa Eastern and Southern</td>
<td>AFE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.982136</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2.532352e+11</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>3.098907e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7983</td>
<td>Africa Western and Central</td>
<td>AFW</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.473669</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>1.218021e+11</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>2.067390e+08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7984</td>
<td>Angola</td>
<td>AGO</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>0.554586</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>1.122876e+10</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>1.182864e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7985</td>
<td>Albania</td>
<td>ALB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>1.819542</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2.028554e+09</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>3.286542e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7986</td>
<td>Andorra</td>
<td>AND</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>1990</td>
<td>7.653680</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>1.029048e+09</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>5.356900e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15953</td>
<td>World</td>
<td>WLD</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>4.435673</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>8.765425e+13</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>7.742682e+09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15954</td>
<td>Samoa</td>
<td>WSM</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>1.415729</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>9.129445e+08</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>2.119050e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15957</td>
<td>South Africa</td>
<td>ZAF</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>7.568640</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>3.885320e+11</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>5.808706e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15958</td>
<td>Zambia</td>
<td>ZMB</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>0.369958</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2.330867e+10</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>1.838048e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15959</td>
<td>Zimbabwe</td>
<td>ZWE</td>
<td>CO2 emissions (metric tons per capita)</td>
<td>EN.ATM.CO2E.PC</td>
<td>2019</td>
<td>0.765894</td>
<td>GDP (current US$)</td>
<td>NY.GDP.MKTP.CD</td>
<td>2.183223e+10</td>
<td>Population, total</td>
<td>SP.POP.TOTL</td>
<td>1.535461e+07</td>
</tr>
</tbody>
</table>

<p>6937 rows √ó 12 columns</p>
</div>
</div>
</div>
<p><strong>Regress per capita emissions on gdp per capita and comment.</strong></p>
<div id="3c8497fd-1735-4054-aab7-169e44db5572" class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula <span class="im">import</span> api <span class="im">as</span> smf</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_kuznetz[<span class="st">'GDP_per_capita'</span>]<span class="op">=</span>df_kuznetz[<span class="st">'GDP'</span>]<span class="op">/</span><span class="dv">1000</span><span class="op">/</span>df_kuznetz[<span class="st">'Population'</span>]<span class="co">#on divise le PIB par mille car c'est en million et la population est en milliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1131149d-d268-4cc4-a006-1a0b742cbaef" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model<span class="op">=</span>smf.ols(<span class="st">" Emissions ~ GDP_per_capita "</span>, df_kuznetz)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>res<span class="op">=</span>model.fit()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>res.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.334</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.334</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>3473.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Mon, 03 Apr 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>12:41:31</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-19885.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>6937</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>3.977e+04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>6935</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>3.979e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>2.4500</td>
<td>0.059</td>
<td>41.326</td>
<td>0.000</td>
<td>2.334</td>
<td>2.566</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>0.1852</td>
<td>0.003</td>
<td>58.931</td>
<td>0.000</td>
<td>0.179</td>
<td>0.191</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>3880.879</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.836</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>96298.037</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>2.186</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>20.721</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>21.9</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<p><em>The estimated regresssion is <code>emissions per capita = 2,45+ 0,1852 gdp per capita</code>. Both the intercept and the coefficient are significant, indicating that higher GDP per capita is associated with higher per capita emissions, holding other factors constant. The R-squared of the model is relatively low at 0.334, suggesting that other factors not included in the model may also be important in explaining per capita emissions.</em></p>
<p><strong>Split the sample into the three quantiles, based on gdp/capita in the last period. Run the same regression in all three subsamples. Comment.</strong></p>
<div id="622dc0ca-ad19-4f70-ab9b-ed63280f13e2" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_kuznetz[<span class="st">'Quantile'</span>]<span class="op">=</span> pd.qcut(df_kuznetz[<span class="st">'GDP_per_capita'</span>],q <span class="op">=</span> <span class="dv">3</span>, labels<span class="op">=</span>[<span class="st">'low'</span>, <span class="st">'medium'</span>, <span class="st">'high'</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model_low<span class="op">=</span>smf.ols(<span class="st">" Emissions ~ GDP_per_capita "</span>, df_kuznetz[df_kuznetz[<span class="st">'Quantile'</span>] <span class="op">==</span> <span class="st">"low"</span>])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>res_low<span class="op">=</span>model_low.fit()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>res_low.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.044</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.043</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>68.42</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Mon, 03 Apr 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>2.89e-16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>13:37:32</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-2221.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>1493</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>4448.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>1491</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>4458.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>0.0444</td>
<td>0.073</td>
<td>0.605</td>
<td>0.545</td>
<td>-0.100</td>
<td>0.189</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>1.2173</td>
<td>0.147</td>
<td>8.272</td>
<td>0.000</td>
<td>0.929</td>
<td>1.506</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>1261.416</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.783</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>26143.353</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>4.011</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>21.865</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>6.47</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div id="f566457b-c347-4cf7-b14b-965930ed845e" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model_medium<span class="op">=</span>smf.ols(<span class="st">" Emissions ~ GDP_per_capita "</span>, df_kuznetz[df_kuznetz[<span class="st">'Quantile'</span>] <span class="op">==</span> <span class="st">"medium"</span>])</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>res_medium<span class="op">=</span>model_medium.fit()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>res_medium.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.096</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.095</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>274.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Mon, 03 Apr 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>9.77e-59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>13:38:08</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-5698.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>2600</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>1.140e+04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>2598</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>1.141e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>0.7320</td>
<td>0.099</td>
<td>7.418</td>
<td>0.000</td>
<td>0.539</td>
<td>0.926</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>0.6774</td>
<td>0.041</td>
<td>16.576</td>
<td>0.000</td>
<td>0.597</td>
<td>0.758</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>1316.986</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.691</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>7900.449</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>2.395</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>10.071</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>6.42</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div id="304fdc33-d7e6-4fd5-a24b-d5f31e7bd272" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>model_high<span class="op">=</span>smf.ols(<span class="st">" Emissions ~ GDP_per_capita "</span>, df_kuznetz[df_kuznetz[<span class="st">'Quantile'</span>] <span class="op">==</span> <span class="st">"high"</span>])</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>res_high<span class="op">=</span>model_high.fit()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>res_high.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.131</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.130</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>427.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Mon, 03 Apr 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>1.37e-88</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>13:38:39</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-8941.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>2844</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>1.789e+04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>2842</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>1.790e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>5.7100</td>
<td>0.152</td>
<td>37.652</td>
<td>0.000</td>
<td>5.413</td>
<td>6.007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>0.1068</td>
<td>0.005</td>
<td>20.676</td>
<td>0.000</td>
<td>0.097</td>
<td>0.117</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>1447.885</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.902</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>12763.970</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>2.245</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>12.357</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>42.3</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<p><em>These three linear regressions show us that the higher the GDP per capita of countries, the higher the R-squared. This means that the model is more predictive for countries with a ‚Äúhigh‚Äù GDP, the higher their GDP per capita, the higher their per capita emissions. This partly confirms the Kuznetz curve hypothesis</em></p>
<p><strong>Instead of splitting the sample, run a nonlinear regression:</strong></p>
<p><span class="math display">\[\frac{ \text{emissions}_{i t} }{ \text{population}_{i t} } = \alpha + \beta_1*\frac{ \text{gdp}_{i t}}{\text{population}_{i t}} + \beta_2*\left( \frac{ \text{gdp}_{i t}}{\text{population}_{i t}} \right)^2 + \text{other factors}_{i t}\]</span></p>
<p>Justify why <span class="math inline">\(\beta_2&lt;0\)</span> can be interpreted as a proof of the environmental Kuznets hypothesis. Comment.</p>
<div id="115de259-cbe3-4e65-9e84-a8a063cbf6a0" class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>nonlinear_regression<span class="op">=</span>smf.ols(<span class="st">'Emissions ~ GDP_per_capita + np.power(GDP_per_capita, 2)'</span>,df_kuznetz)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>res_nl<span class="op">=</span>nonlinear_regression.fit()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>res_nl.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>Emissions</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.465</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.465</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>3019.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Mon, 03 Apr 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>13:49:50</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>-19121.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>6937</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>3.825e+04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>6934</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>3.827e+04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>2</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>1.5088</td>
<td>0.058</td>
<td>26.113</td>
<td>0.000</td>
<td>1.395</td>
<td>1.622</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDP_per_capita</td>
<td>0.3719</td>
<td>0.005</td>
<td>69.887</td>
<td>0.000</td>
<td>0.361</td>
<td>0.382</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">np.power(GDP_per_capita, 2)</td>
<td>-0.0024</td>
<td>5.76e-05</td>
<td>-41.345</td>
<td>0.000</td>
<td>-0.002</td>
<td>-0.002</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>4662.808</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.905</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>103561.456</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>2.902</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>21.017</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>1.95e+03</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[2] The condition number is large, 1.95e+03. This might indicate that there are<br>strong multicollinearity or other numerical problems.
</div>
</div>
<p><em>The coefficient on the quadratic term, ùõΩ2, is negative, standing at -0,0024, which support the hypothesis that the relationship between emissions and GDP per capita is U-shaped and consistent with the EKH.</em></p>
<p><strong>(Bonus) Suggest a way to improve the regression.</strong></p>
<p><em>this result alone does not provide conclusive proof of the EKH, as the coefficient is not statistically significant and as there may be other factors that influence the relationship between emissions and GDP per capita</em></p>
</section>
</section>
<section id="predicting-booking-cancellations" class="level2">
<h2 class="anchored" data-anchor-id="predicting-booking-cancellations">Predicting booking cancellations</h2>
<p>The scientific review Data-in-Brief, publishes raw data after a rigorous referee process.</p>
<p>The following <a href="https://www.data-in-brief.com/article/S2352-3409(18)31519-1/fulltext">entry</a> contains booking data for two hotels in Portugal, with many informations about the clients.</p>
<p>Your goal is to propose a machine learning model to predict whether a given booking will be cancelled.</p>
<p>(note that the dataset is rather large and that some operations may take some time to complete)</p>
<section id="preparation" class="level3">
<h3 class="anchored" data-anchor-id="preparation">Preparation</h3>
<p><strong>Import the dataset. Describe it.</strong></p>
<div id="8791082b-4d5b-449b-a0b0-7dfe1ad45a66" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pandas.read_csv(<span class="st">"hotel_booking.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="481b984c-0294-4a49-a3ab-4ea966a9d470" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">is_canceled</th>
<th data-quarto-table-cell-role="th">lead_time</th>
<th data-quarto-table-cell-role="th">arrival_date_year</th>
<th data-quarto-table-cell-role="th">arrival_date_week_number</th>
<th data-quarto-table-cell-role="th">arrival_date_day_of_month</th>
<th data-quarto-table-cell-role="th">stays_in_weekend_nights</th>
<th data-quarto-table-cell-role="th">stays_in_week_nights</th>
<th data-quarto-table-cell-role="th">adults</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">babies</th>
<th data-quarto-table-cell-role="th">is_repeated_guest</th>
<th data-quarto-table-cell-role="th">previous_cancellations</th>
<th data-quarto-table-cell-role="th">previous_bookings_not_canceled</th>
<th data-quarto-table-cell-role="th">booking_changes</th>
<th data-quarto-table-cell-role="th">agent</th>
<th data-quarto-table-cell-role="th">company</th>
<th data-quarto-table-cell-role="th">days_in_waiting_list</th>
<th data-quarto-table-cell-role="th">adr</th>
<th data-quarto-table-cell-role="th">required_car_parking_spaces</th>
<th data-quarto-table-cell-role="th">total_of_special_requests</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119386.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>103050.000000</td>
<td>6797.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
<td>119390.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.370416</td>
<td>104.011416</td>
<td>2016.156554</td>
<td>27.165173</td>
<td>15.798241</td>
<td>0.927599</td>
<td>2.500302</td>
<td>1.856403</td>
<td>0.103890</td>
<td>0.007949</td>
<td>0.031912</td>
<td>0.087118</td>
<td>0.137097</td>
<td>0.221124</td>
<td>86.693382</td>
<td>189.266735</td>
<td>2.321149</td>
<td>101.831122</td>
<td>0.062518</td>
<td>0.571363</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.482918</td>
<td>106.863097</td>
<td>0.707476</td>
<td>13.605138</td>
<td>8.780829</td>
<td>0.998613</td>
<td>1.908286</td>
<td>0.579261</td>
<td>0.398561</td>
<td>0.097436</td>
<td>0.175767</td>
<td>0.844336</td>
<td>1.497437</td>
<td>0.652306</td>
<td>110.774548</td>
<td>131.655015</td>
<td>17.594721</td>
<td>50.535790</td>
<td>0.245291</td>
<td>0.792798</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2015.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>6.000000</td>
<td>0.000000</td>
<td>-6.380000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.000000</td>
<td>18.000000</td>
<td>2016.000000</td>
<td>16.000000</td>
<td>8.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>9.000000</td>
<td>62.000000</td>
<td>0.000000</td>
<td>69.290000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.000000</td>
<td>69.000000</td>
<td>2016.000000</td>
<td>28.000000</td>
<td>16.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>14.000000</td>
<td>179.000000</td>
<td>0.000000</td>
<td>94.575000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>1.000000</td>
<td>160.000000</td>
<td>2017.000000</td>
<td>38.000000</td>
<td>23.000000</td>
<td>2.000000</td>
<td>3.000000</td>
<td>2.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>229.000000</td>
<td>270.000000</td>
<td>0.000000</td>
<td>126.000000</td>
<td>0.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.000000</td>
<td>737.000000</td>
<td>2017.000000</td>
<td>53.000000</td>
<td>31.000000</td>
<td>19.000000</td>
<td>50.000000</td>
<td>55.000000</td>
<td>10.000000</td>
<td>10.000000</td>
<td>1.000000</td>
<td>26.000000</td>
<td>72.000000</td>
<td>21.000000</td>
<td>535.000000</td>
<td>543.000000</td>
<td>391.000000</td>
<td>5400.000000</td>
<td>8.000000</td>
<td>5.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Split the dataset between a train set and a validation set.</strong></p>
<p>The validation set should not be touched until the very end.</p>
<div id="223d82ab-0e45-4a81-8ea7-1865651fd3fb" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.model_selection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a48643ab-63bc-4a34-8bca-c1e33acc645a" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_ml, df_validation <span class="op">=</span> sklearn.model_selection.train_test_split(df, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">56</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># until the very last question, you should use *only* the training set</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Split the <code>df_ml</code> dataframe between a training set and a test set.</strong></p>
<div id="59cbd3c2-762b-4677-a46f-37d04fbf5acd" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df_train, df_test <span class="op">=</span> sklearn.model_selection.train_test_split(df_ml)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the various algorithms can be trained and tested using df_train and df_test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="training" class="level3">
<h3 class="anchored" data-anchor-id="training">Training</h3>
<p><strong>Justify why a machine learning model seems appropriate to predict cancellation. Which one(s) could you use?</strong></p>
<p><strong>Implement two or more classification models, to predict cancellation.</strong></p>
<p><strong>Compare their performance on the test set. Which one would you choose?</strong></p>
</section>
<section id="validation" class="level3">
<h3 class="anchored" data-anchor-id="validation">Validation</h3>
<p><strong>Using your preferred model, use the validation set to compute the confusion matrix. Comment.</strong></p>
<div id="3a9a85ee-a346-43d2-a243-b6b80df26ba8" class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>s<span class="op">=</span><span class="st">'The rain in Spain stays mainly in the plane'</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>s[s.index(<span class="st">'m'</span>):s.index(<span class="st">'S'</span>)<span class="op">+</span><span class="dv">5</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>'mainl'</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>